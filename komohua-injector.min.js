class KomohuaInjector extends HTMLElement{connectedCallback(){if(this.el=this.querySelector("input, textarea"),!this.el)return;this.options={};const t=this.getAttribute("items")||"ʻokina=ʻ,ā,ē,ī,ō,ū,Ā,Ē,Ī,Ō,Ū";this.options.items=this.parseItems(t),this.options.replace=this.hasAttribute("replace"),this.options.refocus=this.hasAttribute("refocus"),this.options.injectorClass=this.getAttribute("injector-class")||"injector",this.options.wrapperClass=this.getAttribute("wrapper-class")||"injectors",this.injectors=[],this.options.items.forEach((t=>this.injectors.push(this.buildInjector(t)))),this.hasAttribute("debug")&&window.console.log(this,this.options.items);const e=document.createDocumentFragment(),s=document.createElement("span");s.className=this.options.wrapperClass,e.appendChild(s),this.injectors.forEach((t=>s.appendChild(t))),this.appendChild(e)}buildInjector(t){const e=document.createElement("button");return e.setAttribute("type","button"),e.className=this.options.injectorClass,e.textContent=t.title,e.addEventListener("click",(()=>this.inject(t.text))),e}inject(t){if(this.options.replace)this.el.value=t.replace(/\\n/g,"\n");else{const e=this.el.selectionStart,s=this.el.value.substring(0,e),i=this.el.value.substring(this.el.selectionEnd,this.el.value.length);this.el.value=s+t.replace(/\\n/g,"\n")+i,this.el.selectionStart=e+t.length,this.el.selectionEnd=this.el.selectionStart}const e=new Event("input",{bubbles:!0});e.simulated=!0,e.detail={value:this.el.value},this.el.dispatchEvent(e),this.options.refocus&&this.el.focus()}parseItems(t){const e=[];let s="",i=!1,n=!0,o="";t=t.replace(/&quot;/g,'"').replace(/&#39;/g,"'");for(let l=0;l<t.length;l++){const c=t[l];i?(s+=","===c||"\\"===c?c:"\\"+c,i=!1):"\\"===c?i=!0:"="===c?(o=s,s="",n=!1):","===c?(n&&""===o&&(o=s),e.push({title:o,text:s}),s="",n=!0,o=""):s+=c}return i&&(s+="\\"),n&&""===o&&(o=s),e.push({title:o,text:s}),e}}customElements.define("komohua-injector",KomohuaInjector);